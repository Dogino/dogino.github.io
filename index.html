<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Insta Smokes</title>

<style>
    body {
        margin: 0;
        padding: 10px;
        background: #0e0e0e;
        color: #fff;
        font-family: Arial, sans-serif;
    }

    .wrapper {
        max-width: 900px;
        margin: 0 auto;
        text-align: center;
    }

    .links a {
        display: block;
        margin: 8px 0;
        padding: 14px;
        font-size: 18px;
        font-weight: bold;
        background: #1b1b1b;
        color: #fff;
        text-decoration: none;
        border-radius: 6px;
        cursor: pointer;
    }

    .links a:hover {
        background: #00bcd4;
        color: #000;
    }

    .dual {
        display: flex;
        gap: 8px;
        margin: 8px 0;
    }
    .dual a {
        flex: 1;
        margin: 0;
    }

    /* Area immagine */
    .image-box {
        margin-top: 12px;
        display: none;
        overflow: hidden;
        max-height: 75vh;
        background: #000;
        border-radius: 6px;
        cursor: zoom-in;
    }
    .image-box.zoomed {
        cursor: grab;
    }

    .image-box img {
        width: 100%;
        user-select: none;
        -webkit-user-drag: none; /* blocca drag ghost su Chrome/Steam */
        transform-origin: 0 0;
        transition: transform 0.05s linear;
        display: block;
    }

    .hint {
        margin-top: 6px;
        font-size: 12px;
        color: #aaa;
    }

    .external {
        margin-top: 12px;
    }
    .external a {
        display: inline-block;
        margin: 5px;
        padding: 10px 14px;
        font-size: 14px;
        background: #2a2a2a;
        color: #ccc;
        text-decoration: none;
        border-radius: 5px;
    }
    .external a:hover {
        background: #444;
        color: #fff;
    }
</style>

<script>
let zoomed = false;
let isDragging = false;
let moved = false;

let startX = 0, startY = 0;
let translateX = 0, translateY = 0;

let scale = 1;
const MIN_SCALE = 1;
const MAX_SCALE = 4;
const ZOOM_STEP = 0.2;

function clamp(v, min, max) { return Math.max(min, Math.min(max, v)); }

function applyTransform() {
    const img = document.getElementById("mainImage");
    img.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;
}

function resetView() {
    translateX = 0;
    translateY = 0;
    scale = 1;
    zoomed = false;
    document.getElementById("imageBox").classList.remove("zoomed");
    document.getElementById("imageBox").style.cursor = "zoom-in";
    applyTransform();
}

function showImage(src) {
    const box = document.getElementById("imageBox");
    const img = document.getElementById("mainImage");

    img.src = src;

    isDragging = false;
    moved = false;
    resetView();

    box.style.display = "block";
}

function toggleZoom() {
    // se hai appena trascinato, non toggle
    if (moved) { moved = false; return; }

    const box = document.getElementById("imageBox");

    zoomed = !zoomed;

    if (!zoomed) {
        scale = 1;
        translateX = translateY = 0;
        box.classList.remove("zoomed");
        box.style.cursor = "zoom-in";
    } else {
        scale = 2; // zoom base
        box.classList.add("zoomed");
        box.style.cursor = "grab";
    }

    applyTransform();
}

function startDrag(e) {
    if (!zoomed) return;

    e.preventDefault();
    isDragging = true;
    moved = false;

    startX = e.clientX - translateX;
    startY = e.clientY - translateY;

    document.getElementById("imageBox").style.cursor = "grabbing";
}

function drag(e) {
    if (!isDragging || !zoomed) return;

    e.preventDefault();
    moved = true;

    translateX = e.clientX - startX;
    translateY = e.clientY - startY;

    applyTransform();
}

function endDrag() {
    isDragging = false;
    const box = document.getElementById("imageBox");
    box.style.cursor = zoomed ? "grab" : "zoom-in";
}

// Zoom con rotellina: zooma verso il punto del mouse
function wheelZoom(e) {
    const box = document.getElementById("imageBox");
    const img = document.getElementById("mainImage");

    // se l'immagine non è visibile, niente
    if (box.style.display === "none") return;

    e.preventDefault();

    // se non sei in zoom mode, entra in zoom mode al primo scroll
    if (!zoomed) {
        zoomed = true;
        box.classList.add("zoomed");
        box.style.cursor = "grab";
        scale = 1.6;
    }

    const rect = box.getBoundingClientRect();
    const mouseX = e.clientX - rect.left;
    const mouseY = e.clientY - rect.top;

    // coordinate del mouse rispetto al contenuto trasformato
    const preX = (mouseX - translateX) / scale;
    const preY = (mouseY - translateY) / scale;

    // delta zoom
    const dir = (e.deltaY < 0) ? 1 : -1;
    const newScale = clamp(scale + dir * ZOOM_STEP, MIN_SCALE, MAX_SCALE);

    // aggiorna translate per mantenere il punto sotto il mouse fermo
    translateX = mouseX - preX * newScale;
    translateY = mouseY - preY * newScale;
    scale = newScale;

    // se torni a 1, esci da zoom mode
    if (scale === 1) {
        zoomed = false;
        box.classList.remove("zoomed");
        box.style.cursor = "zoom-in";
        translateX = translateY = 0;
    }

    applyTransform();
}

window.addEventListener("DOMContentLoaded", () => {
    const img = document.getElementById("mainImage");
    // blocca dragstart nativo
    img.addEventListener("dragstart", (e) => e.preventDefault());

    const box = document.getElementById("imageBox");
    // rotellina su box
    box.addEventListener("wheel", wheelZoom, { passive: false });
});
</script>
</head>

<body>
<div class="wrapper">

    <div class="links">
        <a onclick="showImage('img/mirage.jpg')">INSTA SMOKES PER MIRAGE</a>

        <div class="dual">
            <a onclick="showImage('img/ancient_ct.jpg')">ANCIENT PER CT</a>
            <a onclick="showImage('img/ancient_t.jpg')">ANCIENT PER T</a>
        </div>

        <a onclick="showImage('img/inferno.jpg')">INSTA SMOKES PER INFERNO</a>
        <a onclick="showImage('img/overpass.jpg')">INSTA SMOKES PER OVERPASS</a>
    </div>

    <div id="imageBox" class="image-box"
         onclick="toggleZoom()"
         onmousedown="startDrag(event)"
         onmousemove="drag(event)"
         onmouseup="endDrag()"
         onmouseleave="endDrag()">
        <img id="mainImage" src="" alt="Insta Smoke" draggable="false">
    </div>

    <div class="hint">
        Click = zoom ON/OFF • Rotellina = zoom preciso • Trascina (solo zoom) = sposta
    </div>

    <div class="external">
        <a href="https://www.google.de" target="_blank">google.de</a>
        <a href="https://www.faceit.com" target="_blank">faceit.com</a>
    </div>

</div>
</body>
</html>
